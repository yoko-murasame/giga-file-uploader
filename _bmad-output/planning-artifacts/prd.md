---
stepsCompleted: ['step-01-init', 'step-02-discovery', 'step-03-success', 'step-04-journeys', 'step-05-domain', 'step-06-innovation', 'step-07-project-type', 'step-08-scoping', 'step-09-functional', 'step-10-nonfunctional', 'step-11-polish', 'step-12-complete']
classification:
  projectType: desktop_app
  domain: general
  complexity: low
  projectContext: greenfield
inputDocuments:
  - '_bmad-output/analysis/brainstorming-session-2026-02-10.md'
  - '_bmad-output/planning-artifacts/research/technical-gigafile-nu-upload-api-research-2026-02-10.md'
  - '_bmad-output/knowledge-base/lessons/_lessons-learned.md'
workflowType: 'prd'
documentCounts:
  briefs: 0
  research: 1
  brainstorming: 1
  projectDocs: 0
---

# Product Requirements Document - giga-file-uploader

**Author:** Shaoyoko
**Date:** 2026-02-10

## Executive Summary

GigaFile 是一个基于 Tauri (Rust + React) 的跨平台桌面文件上传客户端，作为日本大文件传输服务 gigafile.nu 的本地替代方案。

**核心问题：** gigafile.nu 官方 Web 版上传体验差 -- 断传需手动重试、拖拽体验差、广告干扰。

**价值主张：** "giga.nu 的文件上传，但是稳定、自动、干净。"

**核心交互：** 拖入文件 -> 点上传 -> 拿链接。三步完成，后台自动处理所有麻烦。

**目标用户：** 开发者本人及身边朋友，日常使用 gigafile.nu 分享文件的人群。

**技术栈：** Tauri 2.x + React + Rust，macOS + Windows。

**项目性质：** 自用工具型开源项目，单人开发。

**关键技术风险：** 依赖逆向工程的非官方 API，接口层需可替换架构设计。

## Success Criteria

### User Success

- **完全替代 gigafile.nu 官方 Web 版：** 用户（开发者本人及身边朋友）日常文件分享完全通过 GigaFile 完成，不再需要打开 gigafile.nu 网页
- **零感知失败体验：** 用户在正常网络条件下，感知不到任何上传失败。后台自动重试处理所有瞬时故障，50 次重试以下用户完全无感知
- **三步完成核心流程：** 拖入文件 -> 点上传 -> 拿链接，操作路径不超过 3 步

### Business Success

- **自用工具型项目：** 核心衡量标准是自己和身边朋友完全迁移到 GigaFile，不再使用官方 Web 版
- 开源影响力、下载量等为自然结果，不作为驱动指标

### Technical Success

- **上传可靠性：** 正常网络下上传成功率趋近 100%，所有可重试错误由后台静默处理
- **API 适应性：** 断网恢复、暂停续传等高级功能的可用性取决于 gigafile.nu 接口实际能力，不做超出平台能力的承诺
- **接口层可替换：** 逆向 API 有变更风险，架构上确保接口层可独立替换而不影响上层功能

### Measurable Outcomes

- 核心用户群（开发者本人及身边朋友）在发布后完全停止使用 gigafile.nu 官方 Web 版
- 正常网络条件下用户感知的上传失败率为 0

## User Journeys

### 旅程一：日常文件分享者 - 成功路径

**角色：** 小田，自由职业设计师，经常需要把设计稿发给客户。以前用 gigafile.nu 网页版，广告多、拖拽体验差，但胜在免费无需注册。

**开场：** 小田刚完成一组 UI 设计稿（12 个文件，总共 200MB），需要发给客户审阅。以前她会打开 gigafile.nu，忍受满屏广告，把文件一个个拖进去，祈祷上传别中途断掉。

**行动：** 她打开 GigaFile，直接把整个文件夹拖进窗口。待上传列表立刻展示所有文件的缩略图和大小，她扫一眼确认没问题，删掉一个不需要的草稿文件，点击上传。进度条按分片平稳推进，她切到别的工作窗口继续干活。

**高潮：** 几分钟后，系统提示音响起，系统通知弹出"12 个文件上传完成"。她切回 GigaFile，每个文件旁边都有独立的分享链接，点击复制按钮，链接直接进剪贴板。

**结局：** 她把链接粘贴到聊天窗口发给客户，整个过程不到 5 分钟，没看到一个广告，没遇到一次报错。她已经记不清上次打开 gigafile.nu 网页是什么时候了。

> **揭示的能力需求：** 文件/文件夹拖拽输入、待上传列表预览与删除、多文件并发上传、分片进度显示、完成通知、逐文件链接产出与复制

### 旅程二：大文件上传者 - 边缘场景

**角色：** 阿翔，视频剪辑师，经常需要发送 5-10GB 的视频素材给合作方。gigafile.nu 网页版是他的噩梦 -- 传到 80% 断掉，从头再来。

**开场：** 阿翔有一个 8GB 的视频项目文件需要发给同事。以前用 gigafile.nu 网页上传，传了 40 分钟到 6GB 突然断了，只能从头来，他已经被折磨过太多次。

**行动：** 他把文件拖进 GigaFile，选择保留期 30 天，点击上传。GigaFile 自动将 8GB 文件按 1GB 逻辑分片，每个分片再按 100MB 上传块切割。进度显示清晰 -- 8 个分片各自有独立进度条，他能看到第 3 个分片正在传第 7 块。

**转折：** 传到第 5 个分片时，WiFi 闪断了 3 秒。阿翔什么都没看到 -- GigaFile 后台自动重试了 2 次，分片继续上传。30 秒后网络恢复，上传自动继续。

> **[Phase 2 Growth]** 网络断开时间较长时，GigaFile 将提供双选项提示："网络连接中断，等待恢复中... [继续等待] [断开连接]"。MVP 阶段仅依赖静默自动重试机制。

**结局：** 8GB 文件完整上传成功，阿翔拿到链接。他第一次体验到"大文件上传可以不焦虑"。

> **揭示的能力需求：** 大文件自动分片、分片级进度可视化、静默自动重试、网络断开检测与用户选择、保留期选择

### 旅程三：链接接收者 - 间接用户

**角色：** 客户山本先生，收到小田发来的 gigafile.nu 链接。

**开场：** 山本在聊天消息中收到一个 gigafile.nu 的链接。

**行动：** 他点击链接，在浏览器中打开 gigafile.nu 的标准下载页面，正常下载文件。

**结局：** 下载体验和直接从 gigafile.nu 上传没有任何区别 -- 因为 GigaFile 产出的就是标准的 gigafile.nu 链接。接收者完全不需要知道 GigaFile 的存在。

> **揭示的能力需求：** 产出的链接必须是标准 gigafile.nu 格式，与平台原生上传完全兼容，接收端零感知差异

### Journey Requirements Summary

| 能力领域 | 旅程一 | 旅程二 | 旅程三 |
|----------|--------|--------|--------|
| 文件拖拽/选择输入 | x | x | |
| 待上传列表预览与管理 | x | | |
| 分块上传 + 多线程并发 | x | x | |
| 分片级进度显示 | | x | |
| 静默自动重试 | | x | |
| 网络断开检测与提示 | | x | |
| 大文件自动分片 | | x | |
| 完成通知 | x | | |
| 逐文件链接产出与复制 | x | x | |
| 保留期选择 | | x | |
| 标准 gigafile.nu 链接兼容 | | | x |

## Desktop App Specific Requirements

### Project-Type Overview

GigaFile 是一个基于 Tauri (Rust + React) 的跨平台桌面文件上传客户端，作为 gigafile.nu 的本地替代方案。产品形态为纯本地工具，核心计算（分块、并发上传、重试）在 Rust 后端完成，UI 层使用 React 渲染。

### Platform Support

- **MVP 目标平台：** macOS + Windows
- **Linux：** 不在 MVP 范围内，后续视需求考虑
- **移动端：** 不做
- **框架：** Tauri 2.x，天然支持 macOS / Windows / Linux 构建
- **前端代码共享：** macOS / Windows 共享同一套 React 前端代码，平台差异通过 Tauri 抽象层封装

### System Integration

- **系统通知：** 利用 Tauri 的 notification API 推送上传完成通知
- **提示音：** 上传完成时播放系统提示音
- **无额外系统集成：** 不做右键菜单、文件关联、开机启动等系统级集成

### Update Strategy

- **MVP 阶段不实现自动更新**
- 手动发布 + 用户手动下载新版本
- 后续可利用 Tauri 内置的 updater 机制实现自动更新

### Offline Capabilities

- **应用离线可用：** 无网络时应用可正常打开，查看历史记录，管理待上传文件队列
- **上传功能依赖网络：** 无网络时上传操作不可用，界面明确提示网络状态
- **本地数据完全离线存储：** 历史记录、设置等数据存储在本地文件系统，不依赖任何远程服务

### Implementation Considerations

- **Rust 后端职责：** 文件分块、并发上传调度、重试逻辑、网络状态检测、与 gigafile.nu API 交互
- **React 前端职责：** 文件拖拽/选择 UI、上传进度展示、链接管理、设置面板
- **Tauri IPC：** 前后端通过 Tauri 的 command/event 机制通信，前端发起上传指令，后端推送进度事件

## Project Scoping & Phased Development

### MVP Strategy & Philosophy

**MVP 方式：** 问题解决型 MVP -- 用最短路径解决"gigafile.nu 上传不稳定、体验差"这个核心痛点。

**资源情况：** 单人开发，自用工具，无外部时间压力。

**MVP 核心原则：** 用户完成一次完整的"拖入 -> 上传 -> 拿链接 -> 下次还能找到链接"闭环后，就不再需要打开 gigafile.nu 网页。

### MVP Feature Set (Phase 1)

**Core User Journeys Supported:**
- 旅程一（日常文件分享）：完整支持
- 旅程二（大文件上传）：完整支持
- 旅程三（链接接收者）：天然兼容（产出标准 gigafile.nu 链接）

**Must-Have Capabilities:**

1. **文件输入**
   - 拖拽输入（支持散文件 + 文件夹递归）
   - 文件选择器输入
   - 待上传列表预览（文件名、大小）、可删除

2. **上传引擎**
   - 大文件自动分片（1GB 逻辑分片 + 100MB 上传块）
   - 多线程并发上传（默认 8 线程）
   - 首块串行 + 后续块并行（遵循 gigafile.nu 协议）
   - 静默自动重试（50 次以下用户无感知，超 50 次提示用户）
   - 分片级进度显示

3. **链接产出**
   - 每文件上传成功后立即获得独立链接
   - 一键复制链接
   - 界面内上传完成状态显示

4. **历史记录**
   - 本地存储已上传文件的链接列表（文件名、链接、上传时间、过期日期）
   - 链接过期状态可视化
   - 复制历史链接、删除记录

5. **基础设置**
   - 文件保留期选择（3/5/7/14/30/60/100 天）

6. **平台**
   - macOS + Windows（Tauri 2.x）

### Post-MVP Features

**Phase 2 (Growth):**
- 复制粘贴文件输入
- 三层完成通知（提示音 + 系统通知 + 界面状态）
- 密码保护
- 打包下载功能（可选聚合 ZIP 链接）
- 设置面板扩展（并发数、分片大小、主题）
- 网络断开双选项提示
- 条件性取消分享（如 API 支持）
- 条件性暂停/续传（如 API 支持）

**Phase 3 (Expansion):**
- 插件式工具箱框架 + 左侧边栏导航
- Web 端适配
- 多语言支持（中文 + 日语 + 英语）
- Homebrew / 应用商店分发
- 自动更新（Tauri updater）
- Linux 支持

### Risk Mitigation Strategy

**Technical Risks:**
- **逆向 API 变更风险（高）：** gigafile.nu 随时可能改变接口。缓解：接口层抽象设计，API 交互逻辑集中在独立模块，可快速适配变更。参考 gfile 开源项目跟踪平台变化。
- **首块串行协议约束（中）：** 服务器要求首块串行建立会话。缓解：严格遵循已验证的协议流程，不做优化假设。

**Market Risks:**
- 低风险。自用工具，核心用户群明确（开发者本人及朋友），不依赖外部市场验证。

**Resource Risks:**
- **单人开发（中）：** 缓解：MVP 范围精简聚焦，利用 Tauri 框架减少跨平台适配工作量。如遇资源不足，可进一步缩减 MVP（去掉历史记录，只保留上传 + 链接产出）。

## Functional Requirements

### 文件输入与管理

- FR1: 用户可以通过拖拽将单个或多个文件添加到上传队列
- FR2: 用户可以通过拖拽将文件夹添加到上传队列，系统递归处理目录中所有文件
- FR3: 用户可以通过系统文件选择器选择文件添加到上传队列
- FR4: 用户可以在上传前查看待上传文件列表（文件名、大小）
- FR5: 用户可以从待上传列表中移除不需要的文件

### 术语定义

- **逻辑分片：** 将大文件按固定大小（默认 1GB）切分为多个独立上传单元，每个分片在 gigafile.nu 服务端对应一个独立的上传会话
- **上传块：** 将每个逻辑分片进一步切分为更小的传输单元（默认 100MB），作为单次 HTTP 请求的 payload
- **首块串行：** gigafile.nu 协议要求每个分片的第一个上传块必须单独发送以建立服务端会话，后续块才可并行上传

### 上传引擎

- FR6: 系统可以将大文件自动切分为逻辑分片进行上传
- FR7: 系统可以对每个分片进一步切分为上传块，通过多线程并发上传
- FR8: 系统可以在上传失败时自动静默重试，用户无感知
- FR9: 系统可以在重试超过阈值时向用户展示失败信息并提供操作选择
- FR10: 系统可以在上传前动态发现 gigafile.nu 当前可用的上传服务器
- FR11: 系统可以遵循 gigafile.nu 协议（首块串行建立会话 + 后续块并行上传）

### 上传进度与状态

- FR12: 用户可以查看每个文件的整体上传进度
- FR13: 用户可以查看每个分片的独立上传进度
- FR14: 用户可以在界面上看到上传完成的状态

### 链接产出与分享

- FR15: 系统可以在每个文件上传成功后立即产出该文件的独立下载链接
- FR16: 用户可以一键复制任意文件的下载链接
- FR17: 系统产出的链接为标准 gigafile.nu 格式，与平台原生上传完全兼容

### 历史记录

- FR18: 系统可以在本地持久化存储所有已上传文件的记录（文件名、链接、上传时间、过期日期）
- FR19: 用户可以查看上传历史记录列表
- FR20: 用户可以从历史记录中复制链接
- FR21: 用户可以删除历史记录条目
- FR22: 系统可以可视化展示链接的过期状态（未过期 / 已过期）

### 上传配置

- FR23: 用户可以选择文件在 gigafile.nu 上的保留期限（3/5/7/14/30/60/100 天）

### 平台与应用

- FR24: 应用可以在 macOS 上运行
- FR25: 应用可以在 Windows 上运行
- FR26: 应用可以在无网络状态下正常启动并访问本地数据（历史记录、设置）

## Non-Functional Requirements

### Performance

- NFR1: 文件添加到待上传列表（拖拽/选择）后，列表应在 1 秒内完成渲染和展示
- NFR2: 上传进度更新粒度不低于每 128KB，确保进度条视觉上平滑推进
- NFR3: 单文件链接复制操作应在 200ms 内完成
- NFR4: 应用启动到可操作状态应在 3 秒以内（冷启动）
- NFR5: 历史记录列表加载应在 1 秒以内（1000 条记录以内）

### Integration

- NFR6: gigafile.nu API 交互逻辑必须集中在独立可替换的模块中，API 变更时只需修改该模块
- NFR7: 上传完整性应通过 Content-Length 校验验证，确保文件完整到达服务器
- NFR8: 服务器发现机制必须动态获取当前可用上传服务器，不硬编码服务器地址

### Reliability

- NFR9: 正常网络条件下，用户感知的上传失败率为 0（所有瞬时故障由静默重试覆盖）。度量标准：以用户可见的错误对话框或失败提示出现次数为准，正常网络条件下该次数应为 0
- NFR10: 单次上传会话中，自动重试 50 次以下用户完全无感知
- NFR11: 历史记录数据采用本地持久化存储，应用崩溃或异常退出不丢失已保存的记录
- NFR12: 多文件上传中，单个文件失败不影响其他文件的上传流程

